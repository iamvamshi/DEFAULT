{
  "metadata" : {
    "version" : "1.1.395.0",
    "origin" : "",
    "description" : "Test react flow workflow",
    "tags" : [ ]
  },
  "workflow" : [ {
    "name" : "parameters",
    "type" : "parameter",
    "nodeType" : "parameter",
    "description" : "",
    "properties" : {
      "demo" : "testVal",
      "test1" : "testVal1"
    }
  }, {
    "name" : "sense_incoming_csv_file_1",
    "type" : "airflow.sensors.s3_key_sensor.S3KeySensor",
    "nodeType" : "trigger",
    "description" : "Use this file sensor to sense any incoming CSV files at the configured file path",
    "properties" : {
      "retries" : 0,
      "wildcard_match" : true,
      "retry_delay" : 0,
      "dependsOn" : [ ],
      "ui" : {
        "x" : 50,
        "y" : 364.5
      },
      "poke_interval" : 30,
      "bucket_key" : "s3://datamorph-demo/datasets/covid_case_surveillance/markers/preprocessed/covid_data.csv.marker",
      "id" : "dndnode_0.38021819773626175",
      "timeout" : 300
    }
  }, {
    "name" : "covid_extract_pipeline_1",
    "type" : "datamorphairflow.actions.databricks.DMDatabricksRunNowJobOperator",
    "nodeType" : "action",
    "description" : "",
    "properties" : {
      "retries" : 0,
      "outputTo" : [ "Success", "Failure" ],
      "polling_period_seconds" : 30,
      "dependsOn" : [ "sense_incoming_csv_file_1" ],
      "retry_delay" : 0,
      "ui" : {
        "x" : 235,
        "y" : 360.5
      },
      "pipeline_id" : 1802,
      "databricks_retry_limit" : 3,
      "id" : "dndnode_0.5662561850678633"
    }
  }, {
    "name" : "post_process_1",
    "type" : "airflow.operators.bash.BashOperator",
    "nodeType" : "action",
    "description" : "Move the processed_file",
    "properties" : {
      "retries" : 0,
      "outputTo" : [ "Success", "Failure" ],
      "dependsOn" : [ "covid_extract_pipeline_1:Success" ],
      "retry_delay" : 0,
      "ui" : {
        "x" : 436,
        "y" : 364.5
      },
      "trigger_rule" : "all_success",
      "bash_command" : "aws s3 mv s3://datamorph-demo/datasets/covid_case_surveillance/markers/preprocessed/covid_data.csv.marker s3://datamorph-demo/datasets/covid_case_surveillance/markers/processed/covid_data.csv.marker",
      "id" : "dndnode_0.7905758897550612"
    }
  }, {
    "name" : "success_1",
    "type" : "datamorphairflow.actions.email.DMEmailOperator",
    "nodeType" : "action",
    "description" : "",
    "properties" : {
      "retries" : 0,
      "outputTo" : [ "Success", "Failure" ],
      "html_content" : "Covid Surveillance Pipeline Success Message",
      "from_id" : "datamorph@kwartile.com",
      "dependsOn" : [ "post_process_1:Success" ],
      "retry_delay" : 0,
      "ui" : {
        "x" : 671,
        "y" : 363.5
      },
      "subject" : "DataMorph Application Success Message",
      "trigger_rule" : "all_success",
      "to" : "vinay.joshi@kwartile.com",
      "id" : "dndnode_0.0689394824206444"
    }
  }, {
    "name" : "failure_1",
    "type" : "airflow.contrib.operators.slack_webhook_operator.SlackWebhookOperator",
    "nodeType" : "action",
    "description" : "",
    "properties" : {
      "retries" : 0,
      "outputTo" : [ "Success", "Failure" ],
      "retry_delay" : 0,
      "dependsOn" : [ "covid_extract_pipeline_1:Failure", "post_process_1:Failure" ],
      "ui" : {
        "x" : 620,
        "y" : 499.5
      },
      "trigger_rule" : "one_failed",
      "channel" : "#datamorph-workflow-notifications",
      "id" : "dndnode_0.07448468023388388",
      "message" : "Covid case workflow failure notification",
      "webhook_token" : "/T0EJ4596J/B042AFK5LCC/JdN2OD1lbXLzfZyATgFNLjAg",
      "username" : "DataMorph Workflow Notification",
      "http_conn_id" : "datamorph_slack"
    }
  }, {
    "name" : "action_trigger_1",
    "type" : "datamorphairflow.actions.empty.DMEmptyOperator",
    "nodeType" : "trigger",
    "description" : "",
    "properties" : {
      "dependsOn" : [ ],
      "ui" : {
        "x" : 87,
        "y" : 67
      },
      "id" : "dndnode_0.16656524561213004"
    }
  }, {
    "name" : "branch_1",
    "type" : "datamorphairflow.actions.branch.DMBranchOnReturnValueOperator",
    "nodeType" : "action",
    "description" : "",
    "properties" : {
      "dependsOn" : [ "action_trigger_1" ],
      "ui" : {
        "x" : 262,
        "y" : 67
      },
      "id" : "dndnode_0.9763930158713345",
      "branches" : [ {
        "name" : "branch1",
        "properties" : {
          "match_expression" : "SUCCESS",
          "branch" : [ "email_1" ]
        }
      }, {
        "name" : "branch2",
        "properties" : {
          "match_expression" : "FAILURE",
          "branch" : [ "email_2" ]
        }
      } ]
    }
  }, {
    "name" : "email_1",
    "type" : "datamorphairflow.actions.email.DMEmailOperator",
    "nodeType" : "action",
    "description" : "",
    "properties" : {
      "cc" : "",
      "from_id" : "vk@gmail.com",
      "bcc" : "",
      "dependsOn" : [ "branch_1:branch1" ],
      "subject" : "sub2",
      "trigger_rule" : "all_success",
      "retries" : 0,
      "outputTo" : [ "Success", "Failure" ],
      "html_content" : "test body",
      "retry_delay" : 0,
      "ui" : {
        "x" : 456,
        "y" : 22
      },
      "to" : "vkc@gmail.com",
      "id" : "dndnode_0.9079438723848232"
    }
  }, {
    "name" : "email_2",
    "type" : "datamorphairflow.actions.email.DMEmailOperator",
    "nodeType" : "action",
    "description" : "",
    "properties" : {
      "retries" : 0,
      "outputTo" : [ "Success", "Failure" ],
      "html_content" : "test body",
      "from_id" : "vk@gmail.com",
      "retry_delay" : 0,
      "dependsOn" : [ "branch_1:branch2" ],
      "ui" : {
        "x" : 457,
        "y" : 121
      },
      "subject" : "sub2",
      "trigger_rule" : "all_success",
      "to" : "vkc@gmail.com",
      "id" : "dndnode_0.26634987743563077"
    }
  } ]
}