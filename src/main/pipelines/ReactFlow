{"workflow":[{"name":"parameters","type":"parameter","nodeType":"parameter","description":"","properties":{"demoKey":"TESTVAL","delta":"paramValue"}},{"name":"csv_1","type":"filecsv","nodeType":"source","description":"","properties":{"schema":"","charset":"","lineSep":"","modifiedBefore":"","select":"*","enforceSchema":true,"dateFormat":"","positiveInf":"","multiLine":false,"distinct":false,"nanValue":"","inferSchema":false,"locale":"","maxColumns":20480,"nullValue":"","pathGlobFilter":"","path":"s3://datamorph-dev/datasets/customer_loan/customer-loan.csv","quote":"","ui":{"x":90,"y":135},"spark":{"sql":{"files":{"ignoreCorruptFiles":false,"ignoreMissingFiles":false}}},"delimiter":"","normalizeColumnNamesWithReplacement":"","where":"","extractFileName":"","id":"dndnode_0.7822897438075591","recursiveFileLookup":false,"escape":"","ignoreTrailingWhiteSpace":false,"dependsOn":[],"batch":true,"format":"csv","negativeInf":"","parserLib":"","encoding":"","samplingRatio":1,"modifiedAfter":"","ignoreLeadingWhiteSpace":false,"emptyValue":"","charToEscapeQuoteEscaping":"","header":false,"timestampFormat":"","comment":"","maxCharsPerColumn":-1,"columnNameOfCorruptRecord":""}},{"name":"add_columns_1","type":"addcolumnsprocessor","nodeType":"processor","description":"","properties":{"dependsOn":["csv_1"],"addColumns":[{"name":"test","properties":{"columns":["col"],"transformType":"ascii(col)","sql":"ascii({col})"}},{"name":"test_1","properties":{"columns":["col"],"transformType":"ascii(col)","sql":"ascii({col})"}}],"ui":{"x":255,"y":135},"id":"dndnode_0.7656332773623669"}},{"name":"csv_2","type":"filecsv","nodeType":"sink","description":"","properties":{"select":"*","escapeQuotes":true,"dateFormat":"","nullValue":"","mode":"Overwrite","path":"path","quote":"","ui":{"x":420,"y":135},"id":"dndnode_0.8375162902009341","quoteAll":false,"escape":"","sep":"","partitions":"","partitionBy":"","ignoreTrailingWhiteSpace":true,"dependsOn":["add_columns_1"],"batch":true,"format":"csv","encoding":"","ignoreLeadingWhiteSpace":true,"emptyValue":"","charToEscapeQuoteEscaping":"","header":false,"timestampFormat":"","compression":""}},{"name":"xml_data_1","type":"filexml","nodeType":"source","description":"","properties":{"charset":"","modifiedBefore":"","baseSchemaDirPath":"${UAD_POC_APPLY_UC_BASE_SCHEMAS_HOME}/2019","select":"*","dateFormat":"","excludeAttribute":false,"distinct":false,"inferSchema":true,"nullValue":false,"mode":"PERMISSIVE","pathGlobFilter":"","path":"${UAD_POC_APPLY_UC_DATAHOME}","ui":{"x":30,"y":360},"spark":{"sql":{"files":{"ignoreCorruptFiles":false,"ignoreMissingFiles":false}}},"normalizeColumnNamesWithReplacement":"","rootTag":"UCRecords","extractFileName":"apply_uc_filename","where":"","valueTag":"_VALUE","id":"dndnode_0.6042029302534464","ignoreNamespace":true,"recursiveFileLookup":false,"dependsOn":[],"batch":true,"format":"xml","attributePrefix":"_","ignoreSurroundingSpaces":false,"samplingRatio":1,"rowValidationXSDPath":"${UAD_POC_APPLY_UC_BASE_SCHEMAS_HOME}/2019/UCRecord_v1.1.0.xsd","modifiedAfter":"","timestampFormat":"","rowTag":"UCRecord","columnNameOfCorruptRecord":"_corrupt_record"}},{"name":"check_schemas_1","type":"schemaprocessor","nodeType":"processor","description":"Demo Description","properties":{"dependsOn":["xml_data_1"],"dataFormat":"xml","schemaLocation":"s3://schemaPath","batch":true,"existingSchema":"${UAD_POC_APPLY_UC_BASE_SCHEMAS_HOME}/2018/UCRecord_v1.1.0.xsd","existingSchemaBaseDir":"${UAD_POC_APPLY_UC_BASE_SCHEMAS_HOME}/2018","newSchema":"${UAD_POC_APPLY_UC_BASE_SCHEMAS_HOME}/2019/UCRecord_v1.1.0.xsd","inferSchema":false,"outputTo":"schemaDiff","ui":{"x":210,"y":360},"newSchemaBaseDir":"${UAD_POC_APPLY_UC_BASE_SCHEMAS_HOME}/2019","id":"dndnode_0.2771779346503034","compatibility":"backward"}},{"name":"extract_file_name_1","type":"transformcolumnsprocessor","nodeType":"processor","description":"","properties":{"dependsOn":["check_schemas_1"],"ui":{"x":360,"y":360},"transforms":[{"name":"extract_term_code","description":"Extract the term code from the filename","type":"customsql","properties":{"columns":["apply_uc_filename"],"transformType":"decode(col, charset)","sql":"decode({col}, '{charset}')","dependsOn":"extract_file_name_1"}},{"name":"extract_file_month","description":"Extract the FIleMonth from the file name","type":"customsql","properties":{"columns":["apply_uc_filename"],"transformType":"concat(col1, col2, ...)","sql":"concat({col1}, {col2}, {col3})","dependsOn":"extract_file_name_1"}},{"name":"extract-file-year","description":"Extract the Cycle Year from the file name","type":"customsql","properties":{"columns":["apply_uc_filename"],"transformType":"custom-expression","sql":"function1(function2({col}))","dependsOn":"extract_file_name_1"}}],"id":"dndnode_0.6594797915530379"}},{"name":"convert_term_code_to_num_1","type":"transformcolumnsprocessor","nodeType":"processor","description":"","properties":{"dependsOn":["extract_file_name_1"],"ui":{"x":525,"y":360},"transforms":[{"name":"convert_term_code_to_num","description":"Convert the term code from Char to number","type":"customsql","properties":{"columns":["termcode"],"sql":"CAST(CASE WHEN termcodestr = 'F' THEN 2 WHEN termcodestr = 'W' THEN 3 WHEN termcodestr = 'S' THEN 4 END  as int)"}}],"id":"dndnode_0.7159222780616221"}},{"name":"droptermcodestr_1","type":"dropcolumnsprocessor","nodeType":"processor","description":"","properties":{"dropColumns":["termcodestr"],"dependsOn":["convert_term_code_to_num_1"],"ui":{"x":675,"y":360},"id":"dndnode_0.9115189271038155"}},{"name":"ApplyUC_1","type":"delta","nodeType":"sink","description":"","properties":{"path":"${UAD_POC_APPLY_UC_PROCESSING}","partitionBy":"fileyear,filemonth,termcode","dependsOn":["droptermcodestr_1"],"ui":{"x":840,"y":360},"batch":true,"format":"delta","overwriteSchema":false,"outputmode":"Append","id":"dndnode_0.48156596969082077","mergeSchema":true}}]}